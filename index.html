<!doctype html>
<html>
    <head>
        <script type="text/javascript" language="javascript" src="js/enchant.js"></script>
        
        <script type="text/javascript" language="javascript" src="js/mapMatrix.js"></script>
        <script type="text/javascript" language="javascript" src="js/game.js"></script>
        <script type="text/javascript" language="javascript" src="js/map.js"></script>
        <script type="text/javascript" language="javascript" src="js/pj/pj.js"></script>
        <script type="text/javascript" language="javascript" src="js/pj/paparazzi.js"></script>
        <script type="text/javascript" language="javascript" src="js/pj/celebrity.js"></script>
        <script type="text/javascript" language="javascript" src="js/overrides.js"></script>
    </head>
    <body style="margin:0; padding: 0;">
        <script>
            enchant(); // initialize
            var game = new Game(width, height); // game stage
            game.fps = 30;
            game.preload('images/tileMap.png', 
                         'images/paparazzi.png', 
                         'images/celebrity.png',
                         'misc/camera.wav', 
                         'misc/bgm.wav',
                         'misc/heartbeat.wav'
                         );
            var music = 'misc/bgm.wav';
            var heartbeat = 'misc/heartbeat.wav';
            game.onload = function() {
                var map = getGameMap();
                var scene = new Scene();                

                var celebrity = new Celebrity(10, 30);
                var paparazzi = new Paparazzi(10, 30);
                
                pjsList[0] = paparazzi;
                pjsList[1] = celebrity;

                // Background music
                if (isMusicEnabled) {
                    this.assets[music].play();
                }

                // Heartbreak music
                if (isMusicEnabled) {
                    game.addEventListener('enterframe', function() {
                        this.assets[heartbeat].play();
                    });
                }

                scene.addChild(map);
                for (i = 0; i < pjsList.length; i++) {
                    scene.addChild(pjsList[i].getSprite());
                }
                game.pushScene(scene);
            };
            game.start(); // start the game!
        </script>
    </body>
</html>
